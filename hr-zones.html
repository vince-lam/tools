<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Rate Zone Calculator Comparison - Tools by Vin Lam</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 0;
        }

        .top-nav {
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .top-nav a {
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: color 0.2s;
        }

        .top-nav a:hover {
            color: #764ba2;
        }

        .main-wrapper {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            margin-bottom: 30px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
            line-height: 1.6;
        }

        .inputs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .label-optional {
            color: #999;
            font-weight: 400;
            font-size: 12px;
        }

        input[type="number"] {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .results-section {
            margin-top: 40px;
        }

        .results-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            overflow-x: auto;
            display: block;
        }

        .comparison-table table {
            width: 100%;
            min-width: 1000px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
            position: sticky;
            top: 0;
        }

        .comparison-table td {
            color: #666;
        }

        .method-name {
            font-weight: 600;
            color: #333;
        }

        .zone-range {
            display: inline-block;
            padding: 4px 12px;
            color: white;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
        }

        .zone-bar {
            height: 30px;
            background: linear-gradient(90deg, #e3f2fd 0%, #667eea 50%, #764ba2 100%);
            border-radius: 15px;
            position: relative;
            margin: 5px 0;
        }

        .zone-marker {
            position: absolute;
            top: 0;
            height: 100%;
            background: rgba(102, 126, 234, 0.3);
            border-left: 2px solid #667eea;
            border-right: 2px solid #667eea;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .info-box h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .info-box p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .methods-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .method-card {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 12px;
            border: 1px solid #e0e0e0;
        }

        .method-card h4 {
            color: #333;
            margin-bottom: 6px;
            font-size: 1.1em;
        }

        .method-card .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .method-card .method-badge {
            background: rgba(102, 126, 234, 0.15);
            color: #667eea;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .method-card .formula-display {
            background: #e8e9eb;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #555;
        }

        .method-card p {
            color: #666;
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 10px;
        }

        .zones-table {
            width: 100%;
            margin-top: 10px;
        }

        .zones-table-header {
            display: grid;
            grid-template-columns: 90px 100px 1fr;
            padding: 6px 10px;
            background: #e8e9eb;
            border-radius: 6px 6px 0 0;
            font-size: 10px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
        }

        .zone-row {
            display: grid;
            grid-template-columns: 90px 100px 1fr;
            padding: 10px;
            border-bottom: 1px solid #e0e0e0;
            align-items: center;
        }

        .zone-row:last-child {
            border-bottom: none;
        }

        .zone-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: #333;
        }

        .zone-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .zone-1 { background: #64b5f6; }
        .zone-2 { background: #4db6ac; }
        .zone-3 { background: #ffd54f; }
        .zone-4 { background: #ff8a65; }
        .zone-5 { background: #e57373; }

        .zone-percentage {
            color: #666;
            font-size: 12px;
        }

        .zone-bpm {
            color: #333;
            font-weight: 600;
            font-size: 13px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
        }

        .sources-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        .sources-section h2 {
            color: #333;
            margin-bottom: 20px;
        }

        .sources-section ul {
            list-style: none;
            padding: 0;
        }

        .sources-section li {
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
        }

        .sources-section li:before {
            content: "→";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }

        .sources-section a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .sources-section a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning p {
            color: #856404;
            margin: 0;
        }

        @media (max-width: 1024px) {
            .methods-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 25px;
            }

            h1 {
                font-size: 1.5em;
            }

            .inputs-grid {
                grid-template-columns: 1fr;
            }

            .comparison-table {
                font-size: 14px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .methods-grid {
                grid-template-columns: 1fr;
            }

            .method-card {
                padding: 14px;
            }

            .method-card h4 {
                font-size: 1em;
            }

            .zones-table-header,
            .zone-row {
                grid-template-columns: 75px 90px 1fr;
                padding: 8px;
                font-size: 11px;
            }

            .zone-label {
                font-size: 12px;
            }

            .zone-bpm {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <nav class="top-nav">
        <a href="https://tools.vinlam.com">← More Tools</a>
    </nav>

    <div class="main-wrapper">
        <div class="container">
            <h1>Heart Rate Zone Calculator Comparison</h1>
            <p class="subtitle">
                Different calculators use different methods to determine heart rate zones, leading to significant variations in Zone 2 ranges.
                This tool compares popular methods side-by-side so you can see how much they differ and choose the best approach for your training.
            </p>

            <div class="warning">
                <p><strong>Note:</strong> This tool is for educational purposes only. Consult with a healthcare professional before starting any new exercise program. For most accurate results, get your max heart rate and threshold tested in a lab.</p>
            </div>

            <div class="inputs-grid">
                <div class="input-group">
                    <label>Age <span class="label-optional">(required)</span></label>
                    <input type="number" id="age" value="30" min="1" max="120">
                </div>

                <div class="input-group">
                    <label>Resting Heart Rate <span class="label-optional">(optional, for Karvonen)</span></label>
                    <input type="number" id="restingHR" placeholder="e.g., 60" min="30" max="100">
                </div>

                <div class="input-group">
                    <label>Tested Max Heart Rate <span class="label-optional">(optional)</span></label>
                    <input type="number" id="testedMaxHR" placeholder="e.g., 185" min="100" max="220">
                </div>

                <div class="input-group">
                    <label>Functional Threshold HR <span class="label-optional">(optional, for Friel)</span></label>
                    <input type="number" id="fthr" placeholder="e.g., 170" min="100" max="220">
                </div>
            </div>

            <div class="results-section">
                <h2>Zone 2 Comparison Results</h2>

                <div class="stats-grid" id="statsGrid"></div>

                <div class="comparison-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Inputs Used</th>
                                <th>Max HR</th>
                                <th>Zone 2 Range</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTable"></tbody>
                    </table>
                </div>

                <div class="info-box">
                    <h3>Why Do Results Vary So Much?</h3>
                    <p>Heart rate zone calculations vary because they use different formulas for estimating max heart rate and different percentage ranges for defining zones. Age-based formulas like "220 - age" are simple but can be off by 10-20 bpm. Threshold-based methods require testing but are more accurate for trained athletes. Watch manufacturers typically use simpler age-based formulas for convenience.</p>
                </div>

                <div class="methods-grid" id="methodDetails"></div>
            </div>
        </div>
    </div>

    <script>
        // Calculator methods
        const methods = {
            traditional220: {
                name: "220 - Age (Traditional)",
                description: "Most basic formula. Can be inaccurate by ±10-20 bpm.",
                inputsUsed: "Age",
                badge: "TRADITIONAL",
                zones: [
                    { name: "Zone 1", range: "50-60%", min: 0.50, max: 0.60 },
                    { name: "Zone 2", range: "60-70%", min: 0.60, max: 0.70 },
                    { name: "Zone 3", range: "70-80%", min: 0.70, max: 0.80 },
                    { name: "Zone 4", range: "80-90%", min: 0.80, max: 0.90 },
                    { name: "Zone 5", range: "90-100%", min: 0.90, max: 1.00 }
                ],
                calculate: (inputs) => {
                    const maxHR = 220 - inputs.age;
                    return {
                        maxHR,
                        formula: `Max HR = 220 - ${inputs.age} = ${maxHR}`,
                        zone2Min: Math.round(maxHR * 0.60),
                        zone2Max: Math.round(maxHR * 0.70)
                    };
                }
            },
            tanaka: {
                name: "Tanaka Formula",
                description: "208 - (0.7 × age). More accurate than 220-age, especially for people over 40.",
                inputsUsed: "Age",
                badge: "RESEARCH",
                zones: [
                    { name: "Zone 1", range: "50-60%", min: 0.50, max: 0.60 },
                    { name: "Zone 2", range: "60-70%", min: 0.60, max: 0.70 },
                    { name: "Zone 3", range: "70-80%", min: 0.70, max: 0.80 },
                    { name: "Zone 4", range: "80-90%", min: 0.80, max: 0.90 },
                    { name: "Zone 5", range: "90-100%", min: 0.90, max: 1.00 }
                ],
                calculate: (inputs) => {
                    const maxHR = Math.round(208 - (0.7 * inputs.age));
                    return {
                        maxHR,
                        formula: `Max HR = 208 - (0.7 × ${inputs.age}) = ${maxHR}`,
                        zone2Min: Math.round(maxHR * 0.60),
                        zone2Max: Math.round(maxHR * 0.70)
                    };
                }
            },
            appleGarmin: {
                name: "Apple Watch & Garmin",
                description: "Both use 220 - age for max HR. Zone 2 is 60-70% of max. Default zones, can be customized.",
                inputsUsed: "Age",
                badge: "DEVICES",
                zones: [
                    { name: "Zone 1", range: "50-60%", min: 0.50, max: 0.60 },
                    { name: "Zone 2", range: "60-70%", min: 0.60, max: 0.70 },
                    { name: "Zone 3", range: "70-80%", min: 0.70, max: 0.80 },
                    { name: "Zone 4", range: "80-90%", min: 0.80, max: 0.90 },
                    { name: "Zone 5", range: "90-100%", min: 0.90, max: 1.00 }
                ],
                calculate: (inputs) => {
                    const maxHR = 220 - inputs.age;
                    return {
                        maxHR,
                        formula: `Max HR = 220 - ${inputs.age} = ${maxHR}`,
                        zone2Min: Math.round(maxHR * 0.60),
                        zone2Max: Math.round(maxHR * 0.70)
                    };
                }
            },
            karvonen: {
                name: "Karvonen (HRR)",
                description: "Uses Heart Rate Reserve. Zone 2 = Resting HR + (60-70% of HRR). More personalized.",
                inputsUsed: "Age, Resting HR",
                badge: "HRR METHOD",
                zones: [
                    { name: "Zone 1", range: "50-60% HRR", min: 0.50, max: 0.60 },
                    { name: "Zone 2", range: "60-70% HRR", min: 0.60, max: 0.70 },
                    { name: "Zone 3", range: "70-80% HRR", min: 0.70, max: 0.80 },
                    { name: "Zone 4", range: "80-90% HRR", min: 0.80, max: 0.90 },
                    { name: "Zone 5", range: "90-100% HRR", min: 0.90, max: 1.00 }
                ],
                useHRR: true,
                calculate: (inputs) => {
                    if (!inputs.restingHR) return null;
                    const maxHR = 220 - inputs.age;
                    const hrr = maxHR - inputs.restingHR;
                    return {
                        maxHR,
                        restingHR: inputs.restingHR,
                        hrr: hrr,
                        formula: `HRR = ${maxHR} - ${inputs.restingHR} = ${hrr}`,
                        zone2Min: Math.round(inputs.restingHR + (hrr * 0.60)),
                        zone2Max: Math.round(inputs.restingHR + (hrr * 0.70))
                    };
                }
            },
            friel: {
                name: "Joe Friel (FTHR)",
                description: "Threshold-based zones using tested FTHR. Zone 2 (Endurance) = 81-89% of FTHR.",
                inputsUsed: "FTHR (tested)",
                badge: "THRESHOLD",
                zones: [
                    { name: "Zone 1", range: "<81% FTHR", min: 0.00, max: 0.81 },
                    { name: "Zone 2", range: "81-89% FTHR", min: 0.81, max: 0.89 },
                    { name: "Zone 3", range: "90-93% FTHR", min: 0.90, max: 0.93 },
                    { name: "Zone 4", range: "94-99% FTHR", min: 0.94, max: 0.99 },
                    { name: "Zone 5", range: "100-106% FTHR", min: 1.00, max: 1.06 }
                ],
                useFTHR: true,
                calculate: (inputs) => {
                    if (!inputs.fthr) return null;
                    return {
                        maxHR: `FTHR: ${inputs.fthr}`,
                        fthr: inputs.fthr,
                        formula: `Using FTHR = ${inputs.fthr}`,
                        zone2Min: Math.round(inputs.fthr * 0.81),
                        zone2Max: Math.round(inputs.fthr * 0.89)
                    };
                }
            },
            maf: {
                name: "MAF (Maffetone)",
                description: "Max Aerobic Function = 180 - age. Focuses on aerobic base building and fat adaptation.",
                inputsUsed: "Age",
                badge: "AEROBIC",
                zones: [
                    { name: "Zone 1", range: "<MAF-10", min: 0.00, max: -10 },
                    { name: "Zone 2", range: "MAF-10 to MAF", min: -10, max: 0 },
                    { name: "Zone 3", range: ">MAF", min: 0, max: 999 }
                ],
                useMAF: true,
                calculate: (inputs) => {
                    const maf = 180 - inputs.age;
                    return {
                        maxHR: `MAF: ${maf}`,
                        maf: maf,
                        formula: `MAF = 180 - ${inputs.age} = ${maf}`,
                        zone2Min: Math.round(maf - 10),
                        zone2Max: maf
                    };
                }
            },
            tested: {
                name: "Tested Max HR",
                description: "Uses actual tested max HR from lab or field test. Most accurate when measured correctly.",
                inputsUsed: "Tested Max HR",
                badge: "TESTED",
                zones: [
                    { name: "Zone 1", range: "50-60%", min: 0.50, max: 0.60 },
                    { name: "Zone 2", range: "60-70%", min: 0.60, max: 0.70 },
                    { name: "Zone 3", range: "70-80%", min: 0.70, max: 0.80 },
                    { name: "Zone 4", range: "80-90%", min: 0.80, max: 0.90 },
                    { name: "Zone 5", range: "90-100%", min: 0.90, max: 1.00 }
                ],
                calculate: (inputs) => {
                    if (!inputs.testedMaxHR) return null;
                    return {
                        maxHR: inputs.testedMaxHR,
                        formula: `Using tested Max HR = ${inputs.testedMaxHR}`,
                        zone2Min: Math.round(inputs.testedMaxHR * 0.60),
                        zone2Max: Math.round(inputs.testedMaxHR * 0.70)
                    };
                }
            }
        };

        function getInputs() {
            return {
                age: parseInt(document.getElementById('age').value) || 30,
                restingHR: parseInt(document.getElementById('restingHR').value) || null,
                testedMaxHR: parseInt(document.getElementById('testedMaxHR').value) || null,
                fthr: parseInt(document.getElementById('fthr').value) || null
            };
        }

        function calculateAll() {
            const inputs = getInputs();
            const results = {};
            const resultsForCards = {};

            for (const [key, method] of Object.entries(methods)) {
                const result = method.calculate(inputs);
                if (result) {
                    results[key] = {
                        ...method,
                        ...result
                    };
                    // Also add to card results - we'll show all available methods in cards
                    resultsForCards[key] = {
                        ...method,
                        ...result
                    };
                }
            }

            return { results, resultsForCards };
        }

        function updateResults() {
            const { results, resultsForCards } = calculateAll();
            const tableBody = document.getElementById('resultsTable');
            const statsGrid = document.getElementById('statsGrid');
            const methodDetails = document.getElementById('methodDetails');

            tableBody.innerHTML = '';
            methodDetails.innerHTML = '';

            // Calculate stats from table results only
            const zone2Ranges = Object.values(results).map(r => ({
                min: r.zone2Min,
                max: r.zone2Max
            }));

            const allMins = zone2Ranges.map(r => r.min);
            const allMaxs = zone2Ranges.map(r => r.max);
            const lowestMin = Math.min(...allMins);
            const highestMax = Math.max(...allMaxs);
            const spread = highestMax - lowestMin;

            statsGrid.innerHTML = `
                <div class="stat-card">
                    <div class="stat-label">Lowest Zone 2 Start</div>
                    <div class="stat-value">${lowestMin} bpm</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Highest Zone 2 End</div>
                    <div class="stat-value">${highestMax} bpm</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Spread</div>
                    <div class="stat-value">${spread} bpm</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Methods Compared</div>
                    <div class="stat-value">${Object.keys(results).length}</div>
                </div>
            `;

            // Calculate min and max zone 2 values for color scaling
            const allZone2Mids = Object.values(results).map(r => (r.zone2Min + r.zone2Max) / 2);
            const minMid = Math.min(...allZone2Mids);
            const maxMid = Math.max(...allZone2Mids);

            // Function to get color based on zone 2 midpoint
            function getZoneColor(zone2Min, zone2Max) {
                const midpoint = (zone2Min + zone2Max) / 2;
                // Normalize between 0 and 1
                const normalized = maxMid > minMid ? (midpoint - minMid) / (maxMid - minMid) : 0.5;

                // Interpolate between light purple and dark purple
                // Light: #b8a3e8 (184, 163, 232)
                // Dark: #5e3ba6 (94, 59, 166)
                const r = Math.round(184 - (normalized * (184 - 94)));
                const g = Math.round(163 - (normalized * (163 - 59)));
                const b = Math.round(232 - (normalized * (232 - 166)));

                return `rgb(${r}, ${g}, ${b})`;
            }

            // Populate table
            for (const [key, result] of Object.entries(results)) {
                const row = document.createElement('tr');
                const bgColor = getZoneColor(result.zone2Min, result.zone2Max);

                row.innerHTML = `
                    <td class="method-name">${result.name}</td>
                    <td>${result.inputsUsed}</td>
                    <td>${result.maxHR}</td>
                    <td><span class="zone-range" style="background: ${bgColor}">${result.zone2Min} - ${result.zone2Max} bpm</span></td>
                    <td>${result.description}</td>
                `;
                tableBody.appendChild(row);
            }

            // Populate method detail cards - use resultsForCards to show all available methods
            const inputs = getInputs();
            for (const [key, result] of Object.entries(resultsForCards)) {
                // Add method detail card with all zones
                const card = document.createElement('div');
                card.className = 'method-card';

                // Build zones table
                let zonesHTML = '';
                const method = methods[key];

                if (method.useMAF) {
                    // Special rendering for MAF
                    const mafValue = result.maf;
                    zonesHTML = `
                        <div class="zones-table-header">
                            <div>Zone</div>
                            <div>Range</div>
                            <div>BPM</div>
                        </div>
                        <div class="zone-row">
                            <div class="zone-label"><span class="zone-dot zone-1"></span>Zone 1</div>
                            <div class="zone-percentage">&lt;MAF-10</div>
                            <div class="zone-bpm">&lt;${mafValue - 10}</div>
                        </div>
                        <div class="zone-row">
                            <div class="zone-label"><span class="zone-dot zone-2"></span>Zone 2</div>
                            <div class="zone-percentage">MAF-10 to MAF</div>
                            <div class="zone-bpm">${mafValue - 10} - ${mafValue}</div>
                        </div>
                        <div class="zone-row">
                            <div class="zone-label"><span class="zone-dot zone-3"></span>Zone 3+</div>
                            <div class="zone-percentage">&gt;MAF</div>
                            <div class="zone-bpm">&gt;${mafValue}</div>
                        </div>
                    `;
                } else {
                    zonesHTML = `
                        <div class="zones-table-header">
                            <div>Zone</div>
                            <div>Range</div>
                            <div>BPM</div>
                        </div>
                    `;

                    method.zones.forEach((zone, index) => {
                        let minBPM, maxBPM;

                        if (method.useHRR) {
                            // Karvonen calculation
                            const hrr = result.hrr;
                            const restingHR = result.restingHR;
                            minBPM = Math.round(restingHR + (hrr * zone.min));
                            maxBPM = Math.round(restingHR + (hrr * zone.max));
                        } else if (method.useFTHR) {
                            // FTHR-based calculation
                            const fthr = inputs.fthr;
                            minBPM = Math.round(fthr * zone.min);
                            maxBPM = Math.round(fthr * zone.max);
                        } else {
                            // Standard % of max HR
                            const maxHRValue = typeof result.maxHR === 'number' ? result.maxHR : parseInt(result.maxHR);
                            minBPM = Math.round(maxHRValue * zone.min);
                            maxBPM = Math.round(maxHRValue * zone.max);
                        }

                        zonesHTML += `
                            <div class="zone-row">
                                <div class="zone-label"><span class="zone-dot zone-${index + 1}"></span>${zone.name}</div>
                                <div class="zone-percentage">${zone.range}</div>
                                <div class="zone-bpm">${minBPM} - ${maxBPM}</div>
                            </div>
                        `;
                    });
                }

                card.innerHTML = `
                    <div class="card-header">
                        <h4>${result.name}</h4>
                        <span class="method-badge">${method.badge}</span>
                    </div>
                    <p>${result.description}</p>
                    <div class="formula-display">${result.formula}</div>
                    <div class="zones-table">
                        ${zonesHTML}
                    </div>
                `;
                methodDetails.appendChild(card);
            }
        }

        // Event listeners
        document.getElementById('age').addEventListener('input', updateResults);
        document.getElementById('restingHR').addEventListener('input', updateResults);
        document.getElementById('testedMaxHR').addEventListener('input', updateResults);
        document.getElementById('fthr').addEventListener('input', updateResults);

        // Initial calculation
        updateResults();
    </script>
</body>
</html>
